<ui:composition template="/templates/layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

	<ui:define name="content">

		<h2 style="text-align: center; margin-bottom: 2rem;">Ausbildbare
			Einheiten</h2>

		<h:form id="kaserneForm">

			<div class="grid">
				<ui:repeat value="#{kaserneBean.einheiten}" var="u">

					<div class="col-6 sm:col-4 md:col-3 lg:col-2">
						<div class="unit-card" onclick="this.classList.toggle('flipped')">

							<div class="unit-card-inner">

								<!-- Vorderseite -->
								<div class="unit-face unit-front">

									<!-- Name oben -->
									<div class="unit-name">#{u.displayName}</div>

									<!-- Container für Bild + Abilities -->
									<div class="unit-main">
										<div class="unit-content">
											<!-- Bild -->
											<h:graphicImage name="images/units/#{u.pic}"
												styleClass="unit-image" />

											<!-- Werte unten -->
											<div class="unit-values">
												<h4>Werte</h4>
												<div class="unit-cost-row">
													<span>KP:</span><span>#{u.kommando}</span>
												</div>
												<div class="unit-cost-row">
													<span>AP:</span><span>#{u.ap}</span>
												</div>
												<div class="unit-cost-row">
													<span>VP:</span><span>#{u.vp}</span>
												</div>
												<div class="unit-cost-row">
													<span>HP:</span><span>#{u.hp}</span>
												</div>
												<div class="unit-cost-row">
													<span>MP:</span><span>#{u.mp}</span>
												</div>
											</div>
										</div>

										<!-- Spezialfähigkeiten vertikal rechts -->
										<div class="unit-abilities-vertical">
											<ui:repeat value="#{u.specialAbilities}" var="icon">
												<h:graphicImage name="images/#{icon}"
													styleClass="ability-icon" />
											</ui:repeat>
										</div>
									</div>

								</div>

								<!-- Rückseite -->
								<div class="unit-face unit-back">

									<!-- Name oben -->
									<div class="unit-name">#{u.displayName}</div>

									<!-- Container für Bild + Abilities -->
									<div class="unit-main">
										<div class="unit-content">
											<!-- Bild -->
											<h:graphicImage name="images/units/#{u.pic}"
												styleClass="unit-image" />

											<!-- Werte unten -->
											<div class="unit-values">
												<h4>Kosten</h4>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/erz.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{u.erz}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/gold.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{u.gold}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/holz.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{u.holz}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/nahrung_f.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{u.nahrung}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/silber.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{u.silber}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
											</div>
										</div>

										<!-- Spezialfähigkeiten vertikal rechts -->
										<div class="unit-abilities-vertical">
											<ui:repeat value="#{u.specialAbilities}" var="icon">
												<h:graphicImage name="images/#{icon}"
													styleClass="ability-icon" />
											</ui:repeat>
										</div>
									</div>

								</div>
							</div>
						</div>
						<div class="unit-buttons">
						    <p:commandButton value="Details / Ausbilden"
						                     icon="pi pi-cog"
						                     styleClass="unit-btn"
						                     action="#{kaserneBean.openBuildMenu(u)}"
						                     process="@this"
						                     update="@none" />
						</div>
					</div>
				</ui:repeat>
			</div>
		</h:form>

		<h2 style="text-align: center; margin-bottom: 2rem;">Vorlagen</h2>

		<h:form id="kaserneVorlageForm">

			<div class="grid">
				<ui:repeat value="#{kaserneBean.vorlagen}" var="v">

					<div class="col-6 sm:col-4 md:col-3 lg:col-2">
						<div class="unit-card" onclick="this.classList.toggle('flipped')">

							<div class="unit-card-inner">

								<!-- Vorderseite -->
								<div class="unit-face unit-front">

									<!-- Name oben -->
									<div class="unit-name">#{v.name}</div>

									<!-- Container für Bild + Abilities -->
									<div class="unit-main">
										<div class="unit-content">
											<!-- Bild -->
											<h:graphicImage name="images/units/#{v.pic}"
												styleClass="unit-image" />

											<!-- Werte unten -->
											<div class="unit-values">
												<h4>Werte</h4>
												<div class="unit-cost-row">
													<span>KP:</span><span>#{v.kommando}</span>
												</div>
												<div class="unit-cost-row">
													<span>AP:</span><span>#{v.totalAP}</span>
												</div>
												<div class="unit-cost-row">
													<span>VP:</span><span>#{v.totalVP}</span>
												</div>
												<div class="unit-cost-row">
													<span>HP:</span><span>#{v.totalHP}</span>
												</div>
												<div class="unit-cost-row">
													<span>MP:</span><span>#{v.totalMP}</span>
												</div>
											</div>
										</div>

										<!-- Spezialfähigkeiten vertikal rechts -->
										<div class="unit-abilities-vertical">
											<ui:repeat value="#{v.specialAbilities}" var="icon">
												<h:graphicImage name="images/#{icon}"
													styleClass="ability-icon" />
											</ui:repeat>
										</div>
									</div>

								</div>

								<!-- Rückseite -->
								<div class="unit-face unit-back">

									<!-- Name oben -->
									<div class="unit-name">#{v.name}</div>

									<!-- Container für Bild + Abilities -->
									<div class="unit-main">
										<div class="unit-content">
											<!-- Bild -->
											<h:graphicImage name="images/units/#{v.pic}"
												styleClass="unit-image" />

											<!-- Werte unten -->
											<div class="unit-values">
												<h4>Kosten</h4>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/erz.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{v.totalErz}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/gold.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{v.totalGold}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/holz.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{v.totalHolz}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/nahrung_f.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{v.totalNahrung}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
												<div class="unit-cost-row">
													<h:graphicImage name="images/icons/20x20/silber.png"
													styleClass="rohstoff-icon" />
													<h:outputText value="#{v.totalSilber}">
													    <f:convertNumber groupingUsed="true" />
													</h:outputText>
												</div>
											</div>
										</div>

										<!-- Spezialfähigkeiten vertikal rechts -->
										<div class="unit-abilities-vertical">
											<ui:repeat value="#{v.specialAbilities}" var="icon">
												<h:graphicImage name="images/#{icon}"
													styleClass="ability-icon" />
											</ui:repeat>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="unit-buttons">
						    <p:commandButton value="Baumenü"
						                     icon="pi pi-cog"
						                     styleClass="unit-btn"
						                     action="#{kaserneBean.openBuildMenu(v)}"
						                     process="@this"/>
						
						    <p:commandButton value="Umbenennen"
						                     icon="pi pi-pencil"
						                     styleClass="unit-btn"
						                     onclick="PF('renameDlg#{v.id}').show(); return false;" />
						
						    <p:commandButton value="Löschen"
						                     icon="pi pi-trash"
						                     styleClass="unit-btn btn-danger"
						                     action="#{kaserneBean.deleteVorlage(v)}"
						                     update="kaserneVorlageForm"/>
						</div>
					</div>
					<p:dialog header="Vorlage umbenennen"
			          widgetVar="renameDlg#{v.id}"
			          modal="true"
			          closable="true"
			          resizable="false">
			
					    <h:panelGrid columns="2" cellpadding="5">
					        <h:outputText value="Neuer Name:"/>
					        <p:inputText value="#{kaserneBean.renameBuffer}" />
					    </h:panelGrid>
					
					    <p:commandButton value="Speichern"
					                     icon="pi pi-check"
					                     action="#{kaserneBean.renameVorlage(v)}"
					                     update="kaserneVorlageForm"
					                     oncomplete="PF('renameDlg#{v.id}').hide();" />
					</p:dialog>
				</ui:repeat>
			</div>
			
		</h:form>

	</ui:define>
</ui:composition>
